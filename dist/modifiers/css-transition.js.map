{"version":3,"file":"css-transition.js","sources":["../../src/modifiers/css-transition.js"],"sourcesContent":["import Modifier from 'ember-modifier';\nimport { registerDestructor } from '@ember/destroyable';\nimport {\n  dependencySatisfies,\n  getOwnConfig,\n  macroCondition,\n} from '@embroider/macros';\nimport { buildWaiter } from '@ember/test-waiters';\n\nimport { nextTick, sleep, computeTimeout } from '../utils/transition-utils';\n\nlet waiter;\n\nif (macroCondition(getOwnConfig()?.useTestWaiters)) {\n  waiter = buildWaiter('ember-css-transitions');\n} else {\n  waiter = {\n    beginAsync() {\n      /* fake */\n    },\n    endAsync() {\n      /* fake */\n    },\n  };\n}\n\nlet modifier;\n\nif (macroCondition(dependencySatisfies('ember-modifier', '>=3.2.0 || 4.x'))) {\n  /**\n    Modifier that applies classes. Usage:\n\n    ```hbs\n    <div {{css-transition name=\"example\"}}>\n    <p>Hello world</p>\n    </div>\n    ```\n\n    @class CssTransitionModifier\n    @argument {Function} [didTransitionIn]\n    @argument {Function} [didTransitionOut]\n    @public\n   */\n  class CssTransitionModifier extends Modifier {\n    element = null;\n    clone = null;\n    parentElement = null;\n    nextElementSibling = null;\n    installed = false;\n    finishedTransitionIn = false;\n    isEnabled = true;\n    parentSelector;\n\n    /**\n     * @property el\n     * @type {(HTMLElement|undefined)}\n     * @private\n     * @readonly\n     */\n    get el() {\n      return this.clone || this.element;\n    }\n\n    /**\n     * @property didTransitionIn\n     * @type {(Function|undefined)}\n     * @private\n     */\n    didTransitionIn;\n\n    /**\n     * @property didTransitionOut\n     * @type {(Function|undefined)}\n     * @private\n     */\n    didTransitionOut;\n\n    /**\n     * @property transitionName\n     * @type {(String|undefined)}\n     * @private\n     */\n    transitionName;\n\n    /**\n     * @property enterClass\n     * @type {(String|undefined)}\n     * @private\n     */\n    enterClass;\n\n    /**\n     * @property enterActiveClass\n     * @type {(String|undefined)}\n     * @private\n     */\n    enterActiveClass;\n\n    /**\n     * @property enterToClass\n     * @type {(String|undefined)}\n     * @private\n     */\n    enterToClass;\n\n    /**\n     * @property leaveClass\n     * @type {(String|undefined)}\n     * @private\n     */\n    leaveClass;\n\n    /**\n     * @property leaveActiveClass\n     * @type {(String|undefined)}\n     * @private\n     */\n    leaveActiveClass;\n\n    /**\n     * @property leaveToClass\n     * @type {(String|undefined)}\n     * @private\n     */\n    leaveToClass;\n\n    constructor(owner, args) {\n      super(owner, args);\n\n      registerDestructor(this, () => {\n        if (this.isEnabled === false || !this.finishedTransitionIn) {\n          return;\n        }\n\n        this.guardedRun(this.transitionOut);\n      });\n    }\n\n    modify(element, positional, named) {\n      this.element = element;\n\n      this.setupProperties(positional, named);\n\n      if (named.isEnabled === false || this.installed) {\n        return;\n      }\n\n      this.installed = true;\n      let el = this.getElementToClone();\n      this.parentElement = el.parentElement;\n      this.nextElementSibling = el.nextElementSibling;\n\n      this.guardedRun(this.transitionIn);\n    }\n\n    setupProperties(positional, named) {\n      this.isEnabled = named.isEnabled !== false;\n      this.transitionName = positional[0] || named.name;\n      this.didTransitionIn = named.didTransitionIn;\n      this.didTransitionOut = named.didTransitionOut;\n      this.parentSelector = named.parentSelector;\n\n      this.enterClass =\n        named.enterClass ||\n        (this.transitionName && `${this.transitionName}-enter`);\n\n      this.enterActiveClass =\n        named.enterActiveClass ||\n        (this.transitionName && `${this.transitionName}-enter-active`);\n\n      this.enterToClass =\n        named.enterToClass ||\n        (this.transitionName && `${this.transitionName}-enter-to`);\n\n      this.leaveClass =\n        named.leaveClass ||\n        (this.transitionName && `${this.transitionName}-leave`);\n\n      this.leaveActiveClass =\n        named.leaveActiveClass ||\n        (this.transitionName && `${this.transitionName}-leave-active`);\n\n      this.leaveToClass =\n        named.leaveToClass ||\n        (this.transitionName && `${this.transitionName}-leave-to`);\n    }\n\n    /**\n     * Adds a clone to the parentElement, so it can be transitioned out.\n     *\n     * @private\n     * @method addClone\n     */\n    addClone() {\n      let original = this.getElementToClone();\n      let parentElement = original.parentElement || this.parentElement;\n      let nextElementSibling =\n        original.nextElementSibling || this.nextElementSibling;\n\n      if (\n        nextElementSibling &&\n        nextElementSibling.parentElement !== parentElement\n      ) {\n        nextElementSibling = null;\n      }\n\n      let clone = original.cloneNode(true);\n\n      clone.setAttribute('id', `${original.id}_clone`);\n\n      parentElement.insertBefore(clone, nextElementSibling);\n\n      this.clone = clone;\n    }\n\n    /**\n     * Finds the correct element to clone. If `parentSelector` is present, we will\n     * use the closest parent element that matches that selector. Otherwise, we use\n     * the element's immediate parentElement directly.\n     *\n     * @private\n     * @method getElementToClone\n     */\n    getElementToClone() {\n      if (this.parentSelector) {\n        return this.element.closest(this.parentSelector);\n      } else {\n        return this.element;\n      }\n    }\n\n    /**\n     * Removes the clone from the parentElement\n     *\n     * @private\n     * @method removeClone\n     */\n    removeClone() {\n      if (this.clone.isConnected && this.clone.parentNode !== null) {\n        this.clone.parentNode.removeChild(this.clone);\n      }\n    }\n\n    *transitionIn() {\n      if (this.enterClass) {\n        yield* this.transition({\n          className: this.enterClass,\n          activeClassName: this.enterActiveClass,\n          toClassName: this.enterToClass,\n        });\n\n        if (this.didTransitionIn) {\n          this.didTransitionIn();\n        }\n      }\n\n      this.finishedTransitionIn = true;\n    }\n\n    *transitionOut() {\n      if (this.leaveClass) {\n        // We can't stop ember from removing the element\n        // so we clone the element to animate it out\n        this.addClone();\n\n        yield nextTick();\n\n        yield* this.transition({\n          className: this.leaveClass,\n          activeClassName: this.leaveActiveClass,\n          toClassName: this.leaveToClass,\n        });\n\n        this.removeClone();\n\n        if (this.didTransitionOut) {\n          this.didTransitionOut();\n        }\n\n        this.clone = null;\n      }\n    }\n\n    /**\n     * Transitions the element.\n     *\n     * @private\n     * @method transition\n     * @param {Object} args\n     * @param {String} args.className the class representing the starting state\n     * @param {String} args.activeClassName the class applied during the entire transition. This class can be used to define the duration, delay and easing curve.\n     * @param {String} args.toClassName the class representing the finished state\n     * @return {Generator}\n     */\n    *transition({ className, activeClassName, toClassName }) {\n      let element = this.el;\n\n      // add first class right away\n      this.addClass(className);\n      this.addClass(activeClassName);\n\n      yield nextTick();\n\n      // This is for to force a repaint,\n      // which is necessary in order to transition styles when adding a class name.\n      element.scrollTop;\n\n      // after repaint\n      this.addClass(toClassName);\n      this.removeClass(className);\n\n      // wait for ember to apply classes\n      // set timeout for animation end\n      yield sleep(computeTimeout(element) || 0);\n\n      this.removeClass(toClassName);\n      this.removeClass(activeClassName);\n    }\n\n    /**\n     * Add classNames to el.\n     *\n     * @private\n     * @method addClass\n     * @param {String} className\n     */\n    addClass(className) {\n      this.el.classList.add(...className.trim().split(/\\s+/));\n    }\n\n    /**\n     * Remove classNames from el.\n     *\n     * @private\n     * @method removeClass\n     * @param {String} className\n     */\n    removeClass(className) {\n      this.el.classList.remove(...className.trim().split(/\\s+/));\n    }\n\n    async guardedRun(f, ...args) {\n      const token = waiter.beginAsync();\n\n      let gen = f.call(this, ...args);\n      let isDone = false;\n\n      // stop if the function doesn't have anything else to yield\n      // or if the element is no longer present\n      while (!isDone && this.el) {\n        let { value, done } = gen.next();\n        isDone = done;\n        await value;\n      }\n\n      waiter.endAsync(token);\n    }\n  }\n\n  modifier = CssTransitionModifier;\n} else {\n  modifier = class extends Modifier {\n    clone = null;\n    parentElement = null;\n    nextElementSibling = null;\n    installed = false;\n\n    /**\n     * @property el\n     * @type {(HTMLElement|undefined)}\n     * @private\n     * @readonly\n     */\n    get el() {\n      return this.clone || this.element;\n    }\n\n    /**\n     * @property transitionName\n     * @type {(String|undefined)}\n     * @private\n     * @readonly\n     */\n    get transitionName() {\n      return this.args.positional[0] || this.args.named.name;\n    }\n\n    /**\n     * @property enterClass\n     * @type {(String|undefined)}\n     * @private\n     * @readonly\n     */\n    get enterClass() {\n      return (\n        this.args.named.enterClass ||\n        (this.transitionName && `${this.transitionName}-enter`)\n      );\n    }\n\n    /**\n     * @property enterActiveClass\n     * @type {(String|undefined)}\n     * @private\n     * @readonly\n     */\n    get enterActiveClass() {\n      return (\n        this.args.named.enterActiveClass ||\n        (this.transitionName && `${this.transitionName}-enter-active`)\n      );\n    }\n\n    /**\n     * @property enterToClass\n     * @type {(String|undefined)}\n     * @private\n     * @readonly\n     */\n    get enterToClass() {\n      return (\n        this.args.named.enterToClass ||\n        (this.transitionName && `${this.transitionName}-enter-to`)\n      );\n    }\n\n    /**\n     * @property leaveClass\n     * @type {(String|undefined)}\n     * @private\n     * @readonly\n     */\n    get leaveClass() {\n      return (\n        this.args.named.leaveClass ||\n        (this.transitionName && `${this.transitionName}-leave`)\n      );\n    }\n\n    /**\n     * @property leaveActiveClass\n     * @type {(String|undefined)}\n     * @private\n     * @readonly\n     */\n    get leaveActiveClass() {\n      return (\n        this.args.named.leaveActiveClass ||\n        (this.transitionName && `${this.transitionName}-leave-active`)\n      );\n    }\n\n    /**\n     * @property leaveToClass\n     * @type {(String|undefined)}\n     * @private\n     * @readonly\n     */\n    get leaveToClass() {\n      return (\n        this.args.named.leaveToClass ||\n        (this.transitionName && `${this.transitionName}-leave-to`)\n      );\n    }\n\n    didInstall() {\n      if (this.args.named.isEnabled === false) {\n        return;\n      }\n\n      let el = this.getElementToClone();\n      this.parentElement = el.parentElement;\n      this.nextElementSibling = el.nextElementSibling;\n\n      this.guardedRun(this.transitionIn);\n    }\n\n    willRemove() {\n      if (this.args.named.isEnabled === false || !this.installed) {\n        return;\n      }\n\n      this.guardedRun(this.transitionOut);\n    }\n\n    /**\n     * Adds a clone to the parentElement so it can be transitioned out\n     *\n     * @private\n     * @method addClone\n     */\n    addClone() {\n      let original = this.getElementToClone();\n      let parentElement = original.parentElement || this.parentElement;\n      let nextElementSibling =\n        original.nextElementSibling || this.nextElementSibling;\n\n      if (\n        nextElementSibling &&\n        nextElementSibling.parentElement !== parentElement\n      ) {\n        nextElementSibling = null;\n      }\n\n      let clone = original.cloneNode(true);\n\n      clone.setAttribute('id', `${original.id}_clone`);\n\n      parentElement.insertBefore(clone, nextElementSibling);\n\n      this.clone = clone;\n    }\n\n    /**\n     * Finds the correct element to clone. If `parentSelector` is present, we will\n     * use the closest parent element that matches that selector. Otherwise we use\n     * the element's immediate parentElement directly.\n     *\n     * @private\n     * @method getElementToClone\n     */\n    getElementToClone() {\n      if (this.args.named.parentSelector) {\n        return this.element.closest(this.args.named.parentSelector);\n      } else {\n        return this.element;\n      }\n    }\n\n    /**\n     * Removes the clone from the parentElement\n     *\n     * @private\n     * @method removeClone\n     */\n    removeClone() {\n      if (this.clone.isConnected && this.clone.parentNode !== null) {\n        this.clone.parentNode.removeChild(this.clone);\n      }\n    }\n\n    *transitionIn() {\n      if (this.enterClass) {\n        yield* this.transition({\n          className: this.enterClass,\n          activeClassName: this.enterActiveClass,\n          toClassName: this.enterToClass,\n        });\n\n        if (this.args.named.didTransitionIn) {\n          this.args.named.didTransitionIn();\n        }\n      }\n\n      this.installed = true;\n    }\n\n    *transitionOut() {\n      if (this.leaveClass) {\n        // We can't stop ember from removing the element\n        // so we clone the element to animate it out\n        this.addClone();\n\n        yield nextTick();\n\n        yield* this.transition({\n          className: this.leaveClass,\n          activeClassName: this.leaveActiveClass,\n          toClassName: this.leaveToClass,\n        });\n\n        this.removeClone();\n\n        if (this.args.named.didTransitionOut) {\n          this.args.named.didTransitionOut();\n        }\n\n        this.clone = null;\n      }\n    }\n\n    /**\n     * Transitions the element.\n     *\n     * @private\n     * @method transition\n     * @param {Object} args\n     * @param {String} args.className the class representing the starting state\n     * @param {String} args.activeClassName the class applied during the entire transition. This class can be used to define the duration, delay and easing curve.\n     * @param {String} args.toClassName the class representing the finished state\n     * @return {Generator}\n     */\n    *transition({ className, activeClassName, toClassName }) {\n      let element = this.el;\n\n      // add first class right away\n      this.addClass(className);\n      this.addClass(activeClassName);\n\n      yield nextTick();\n\n      // This is for to force a repaint,\n      // which is necessary in order to transition styles when adding a class name.\n      element.scrollTop;\n\n      // after repaint\n      this.addClass(toClassName);\n      this.removeClass(className);\n\n      // wait for ember to apply classes\n      // set timeout for animation end\n      yield sleep(computeTimeout(element) || 0);\n\n      this.removeClass(toClassName);\n      this.removeClass(activeClassName);\n    }\n\n    /**\n     * Add classNames to el.\n     *\n     * @private\n     * @method addClass\n     * @param {String} className\n     */\n    addClass(className) {\n      this.el.classList.add(...className.trim().split(/\\s+/));\n    }\n\n    /**\n     * Remove classNames from el.\n     *\n     * @private\n     * @method removeClass\n     * @param {String} className\n     */\n    removeClass(className) {\n      this.el.classList.remove(...className.trim().split(/\\s+/));\n    }\n\n    async guardedRun(f, ...args) {\n      const token = waiter.beginAsync();\n\n      let gen = f.call(this, ...args);\n      let isDone = false;\n\n      // stop if the function doesn't have anything else to yield\n      // or if the element is no longer present\n      while (!isDone && this.el) {\n        let { value, done } = gen.next();\n        isDone = done;\n        await value;\n      }\n\n      waiter.endAsync(token);\n    }\n  };\n}\n\nexport default modifier;\n"],"names":["waiter","macroCondition","getOwnConfig","useTestWaiters","buildWaiter","beginAsync","endAsync","modifier","dependencySatisfies","CssTransitionModifier","Modifier","el","clone","element","constructor","owner","args","_defineProperty","registerDestructor","isEnabled","finishedTransitionIn","guardedRun","transitionOut","modify","positional","named","setupProperties","installed","getElementToClone","parentElement","nextElementSibling","transitionIn","transitionName","name","didTransitionIn","didTransitionOut","parentSelector","enterClass","enterActiveClass","enterToClass","leaveClass","leaveActiveClass","leaveToClass","addClone","original","cloneNode","setAttribute","id","insertBefore","closest","removeClone","isConnected","parentNode","removeChild","transition","className","activeClassName","toClassName","nextTick","addClass","scrollTop","removeClass","sleep","computeTimeout","classList","add","trim","split","remove","f","token","gen","call","isDone","value","done","next","didInstall","willRemove"],"mappings":"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"}